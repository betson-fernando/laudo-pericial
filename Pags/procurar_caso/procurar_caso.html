<!DOCTYPE html>
<html lang="pt">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=devide-width, initial-scale=1.0">
	<title>App de local</title>
	
	<style>
		body {text-align: center;}
		#entrarDados {float: left; width: 50%; background-color: darkslategray; color: floralwhite}
		#procDados {float: left; width: 50%; background-color: floralwhite; color: darkslategray}
		input {width: 120px}
		.seta {width: 5%}
	</style>

</head>

<body>

		
	<div id="entrarDados">
		<div id="titulo" display="inline">
			<label for="numCaso">Número do caso:</label>
			<input id="numCaso" class="campoBusca" type="number">
			
			<label for="anoCaso">Ano:</label>
			<input id="anoCaso" class="campoBusca" type="number">
		</div>
		<br><br><br>

		<form>
			
			<label for="rep">REP: </label>
			<input id="rep" type="text"><br>
			
			<label for="req">Requisição: </label>
			<input id="req" type="text">
			<span><input id="oficioBtn" type="radio"><label for="oficioBtn">Ofício?</label></span><br>
			
			<label for="natureza">Natureza: </label>
			<select id="natureza" name="natureza"></select><br>
			
			<label for="dataOc">Data da ocorrência: </label>
			<input id="dataOc" type="date"><br>
			
			<label for="opIsol">Operativa responsável pelo isolamento</label>
			<input id="opIsol" type="text"><br>
			
			<label for="nomeIsol">Nome do responsável pelo isolamento</label>
			<input id="nomeIsol" type="text"><br>

			<label for="matIsol">Matrícula do responsável pelo isolamento</label>
			<input id="matIsol" type="number"><br>

			<label for="batIsol">Grupamento do responsável pelo isolamento</label>
			<input id="batIsol" type="text">
		

			<div>
				<h4>Incluir vítimas:</h1>
				<input type="radio" name="incluirVit" id="incluirVit">
				
				<h4>Incluir veículos:</h4>
				<input type="radio" name="incluirVeic" id="incluirVeic">
				
			</div>
			<br><br>
		</form>
		
		<button id="inserir">INSERIR</button>
		<button id="atualizar">ATUALIZAR</button>
		<button id="deletar">DELETAR</button>
	</div>
		
	<div id="procDados">
		<h1>Procurar caso</h1>
		
		<h4>Número de caso</h4>
		<input id="procurar" type="text"> <br><br>
		<button id="procurarBtn">PROCURAR</button>
		
		<h3 id="pesqNumCaso"></h3>
	</div>
	
	

	<script type="module">
		// Import the functions you need from the SDKs you need
		import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
		import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";
		// TODO: Add SDKs for Firebase products that you want to use
		// https://firebase.google.com/docs/web/setup#available-libraries

		// Your web app's Firebase configuration
		// For Firebase JS SDK v7.20.0 and later, measurementId is optional
		const firebaseConfig = {
			apiKey: "AIzaSyAtMHpDVitPfC4z63e86mYmZpB5FK5aHow",
			authDomain: "laudo-pericial-413714.firebaseapp.com",
			databaseURL: "https://laudo-pericial-413714-default-rtdb.firebaseio.com",
			projectId: "laudo-pericial-413714",
			storageBucket: "laudo-pericial-413714.appspot.com",
			messagingSenderId: "673827156393",
			appId: "1:673827156393:web:541110d56c4a2f28ae94b8",
			measurementId: "G-BBS3S21XY7"
		};

		// Initialize Firebase
		const app = initializeApp(firebaseConfig);
		const analytics = getAnalytics(app);

		import {getDatabase, set, get, update, remove, ref, child} from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js"

		const db = getDatabase();

		let numCaso = document.querySelector("#numCaso");
		let anoCaso = document.querySelector("#anoCaso");
		
		let rep = document.querySelector("#rep");
		let req = document.querySelector("#req");
		let natSel = document.querySelector("#natureza");
		let dataOc = document.querySelector("#dataOc");
		let opIsol = document.querySelector("#opIsol");
		var nomeIsol = document.querySelector("#nomeIsol");
		var matIsol = document.querySelector("#matIsol");
		var batIsol = document.querySelector("#batIsol");
		
		var incluirVit = document.querySelector("#incluirVit");
		var incluirVeic = document.querySelector("#incluirVeic");
		var procurar = document.querySelector("#procurar");
	  
		var inserirBtn = document.querySelector("#inserir")
		var atualizarBtn = document.querySelector("#atualizar")
		var deletarBtn = document.querySelector("#deletar")
		var procurarBtn = document.querySelector("#procurarBtn")
		
		
		//CARREGAR DIA ATUAL:
		var currentDate= new Date();
		var day = ("0" + currentDate.getDate()).slice(-2);
		var month = ("0" + (currentDate.getMonth() + 1)).slice(-2);
		var year = currentDate.getFullYear()

		dataOc.value = currentDate.getFullYear()+"-"+(month)+"-"+(day);

		//CARREGAR DADOS DA NATUREZA:
		let naturezas = ["Homicídio", "Suicídio", "Morte a esclarecer", "Perícia em veículo", "Perícia em local", "outro", "QTA"];
		for (const natureza of naturezas){
			let opt = document.createElement('option');
			opt.value = String(natureza);
			opt.innerHTML = String(natureza);
			natSel.appendChild(opt);
		}
		
		
		function Inserir() {
		
			console.log("Entrou");
			set(ref(db, "casoscol/" + numCaso.value), {
				numCasoVal: numCaso.value,
				opIsolVal: opIsol.value,
				nomeIsolVal: nomeIsol.value,
				matIsolVal: matIsol.value,
				batIsol: batIsol.value,
				incluirVit: incluirVit.value,
				incluirVeic: incluirVeic.value,
				procurarVal: procurar.value
			})
			.then(()=>{
				alert("Caso cadastrado com sucesso!")
			})
			.catch((error)=>{
			alert(error)
			});
		}
		
		function Procurar(num, ano) {
			let strCaso = String(num).concat('/', ano);
		}
		
		function Atualizar() {
		
		}
		
		function Deletar() {
		
		}
		
		
		//=================================== DECLARAÇÃO DE EVENTOS =======================================
		for (const field of document.querySelectorAll(".campoBusca")){
			field.addEventListener('keydown', (e)=>{
				if (['Enter', 'NumpadEnter'].includes(e.code) && Number.isInteger(Number(numCaso.value)) && Number.isInteger(Number(anoCaso.value)) && numCaso.value>0 && anoCaso.value>2023) {
					Procurar(numCaso, anoCaso);
				}
			})
		}

		procurarBtn.addEventListener("click", Procurar);
		atualizarBtn.addEventListener("click", Atualizar);
		
	  
	</script>
</body>
</html>
